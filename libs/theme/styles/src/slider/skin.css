/*
 * Copyright 2022 Watheia Labs, LLC. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 */

:root {
  --slider-focus-ring-size-key-focus: var(--alias-focus-ring-size);

  /* todo: remove when fixed */
  --slider-handle-border-color-key-focus: var(--global-color-gray-800);
  --slider-handle-focus-ring-color-key-focus: var(--alias-focus-color);
}

.Slider {
  --slider-track-gradient: var(--slider-track-color);
}

.Slider-track {
  &::before {
    background: var(--slider-track-gradient);
    background-size: var(--track-background-size);
    background-position: var(--track-background-position);
  }
}

.Slider-labelContainer {
  color: var(--label-text-color);
}

.Slider--filled {
  .Slider-track:first-child {
    &::before {
      background: var(--slider-fill-track-color);
    }
  }
}

.Slider-fill {
  &::before {
    background: var(--slider-fill-track-color);
  }
}

.Slider-buffer {
  &::before,
  &::after {
    background: var(--slider-player-track-buffer-color);
  }
}

.Slider-ramp {
  path {
    fill: var(--slider-track-color);
  }
}

.Slider-handle {
  border-color: var(--slider-handle-border-color);
  background: var(--slider-handle-background-color);

  &:hover {
    border-color: var(--slider-handle-border-color-hover);
  }

  &.is-focused {
    border-color: var(--slider-handle-border-color-key-focus);

    &:before {
      box-shadow: 0 0 0 var(--slider-focus-ring-size-key-focus)
        var(--slider-handle-focus-ring-color-key-focus);
    }
  }

  &:active,
  &.is-dragged {
    border-color: var(--slider-handle-border-color-down);
  }
}

.Slider--ramp {
  .Slider-handle {
    /* We can't draw this one correctly without this hack : ( */
    box-shadow: 0 0 0 4px var(--alias-background-color-default);
  }
}

.Slider-input {
  background: transparent;
}

.Slider-tick {
  &:after {
    background-color: var(--slider-tick-mark-color);
  }
}

.Slider-handle {
  &.is-dragged {
    border-color: var(--slider-handle-border-color-down);
    background: var(--slider-handle-background-color-down);
  }
}

.Slider--range {
  .Slider-track {
    &:not(:first-of-type):not(:last-of-type) {
      &:before {
        background: var(--slider-fill-track-color);
      }
    }
  }
}

.Slider--color {
  .Slider-controls::before {
    background-color: var(--global-color-static-white);
    /* Add a half-percent to fix diagonal line issue in Chrome on non-retina displays */
    background-image: linear-gradient(
        -45deg,
        transparent 75.5%,
        var(--global-color-static-gray-500) 75.5%
      ),
      linear-gradient(45deg, transparent 75.5%, var(--global-color-static-gray-500) 75.5%),
      linear-gradient(-45deg, var(--global-color-static-gray-500) 25.5%, transparent 25.5%),
      linear-gradient(45deg, var(--global-color-static-gray-500) 25.5%, transparent 25.5%);
    background-size: var(--global-dimension-static-size-200)
      var(--global-dimension-static-size-200);
    background-position: 0 0, 0 var(--global-dimension-static-size-100),
      var(--global-dimension-static-size-100) calc(-1 * var(--global-dimension-static-size-100)),
      calc(-1 * var(--global-dimension-static-size-100)) 0;
    z-index: 0;
  }
  .Slider-track {
    background-color: transparent;
    background-image: linear-gradient(
      to right,
      var(--slider-color-track-background-color-gradient-start),
      var(--slider-color-track-background-color-gradient-end)
    );
    box-shadow: inset 0 0 0 1px var(--slider-color-track-border-color);
    &::before {
      display: none;
    }
  }
  .Slider-handle {
    box-shadow: inset 0 0 0 1px var(--slider-color-handle-inset-border-color),
      0 0 0 1px var(--slider-color-handle-outset-border-color);
    border-color: var(--slider-color-handle-border-color);
    background: var(--slider-color-handle-color);

    &.is-focused {
      box-shadow: 0 0 0 1px var(--slider-color-handle-outset-border-color-key-focus);
    }
  }
}

.Dial-labelContainer {
  @inherit: .Slider-labelContainer;
}

.Dial-handle {
  box-shadow: none;

  &:before {
    display: none;
  }

  &::after {
    background-color: var(--dial-handle-marker-color);
  }

  &:hover {
    &::after {
      background-color: var(--dial-handle-marker-color-hover);
    }
  }

  &.is-focused {
    background-color: var(--slider-handle-background-color-key-focus);

    border-color: var(--slider-handle-border-color-key-focus);

    &::after {
      background-color: var(--dial-handle-marker-color-key-focus);
    }
  }

  &:active,
  &.is-dragged {
    background-color: var(--dial-border-color-hover);

    border-color: var(--slider-handle-border-color-down);

    &::after {
      background-color: var(--dial-handle-marker-color-key-focus);
    }
  }
}

.Dial-controls {
  &::before,
  &::after {
    background-color: var(--dial-min-max-tick-color);
  }
}

.Dial {
  &.is-disabled {
    .Dial-labelContainer {
      color: var(--label-text-color-disabled);
    }
    .Dial-controls {
      &::after,
      &::before {
        background-color: var(--slider-handle-border-color-disabled);
      }
    }
    .Dial-handle {
      border-color: var(--slider-handle-border-color-disabled);
      background: var(--alias-background-color-default);

      &:hover,
      &:active {
        border-color: var(--slider-handle-border-color-disabled);
        background: var(--slider-handle-background-color);
      }

      &::after,
      &::before {
        background-color: var(--slider-track-color-disabled);
      }
    }
  }
}

.Slider {
  &.is-disabled {
    .Slider-labelContainer {
      color: var(--label-text-color-disabled);
    }

    .Slider-handle {
      border-color: var(--slider-handle-border-color-disabled);
      background: var(--alias-background-color-default);

      &:hover,
      &:active {
        border-color: var(--slider-handle-border-color-disabled);
        background: var(--slider-handle-background-color);
      }
    }
    .Slider-track {
      &::before {
        background: var(--slider-track-color-disabled);
      }
    }
    &.Slider--filled {
      .Slider-track:first-child {
        &::before {
          background: var(--slider-fill-track-color-disabled);
        }
      }
    }
    .Slider-fill {
      &::before {
        background: var(--slider-fill-track-color-disabled);
      }
    }
    .Slider-buffer {
      &::before {
        background: var(--slider-player-track-buffer-color-disabled);
      }
    }
    .Slider-ramp {
      path {
        fill: var(--slider-ramp-track-color-disabled);
      }
    }

    &.Slider--color {
      .Slider-track {
        background: var(--slider-color-track-color-disabled) !important;
        box-shadow: none;
      }
      .Slider-handle {
        background: var(--slider-color-handle-color-disabled);
        box-shadow: none;
        border-color: var(--slider-color-handle-border-color-disabled);

        &:hover,
        &:active {
          background: var(--slider-color-handle-color-disabled);
          box-shadow: none;
          border-color: var(--slider-color-handle-border-color-disabled);
        }
      }
    }

    &.Slider--range {
      .Slider-track {
        &:not(:first-of-type):not(:last-of-type) {
          &:before {
            background: var(--slider-fill-track-color-disabled);
          }
        }
      }
    }
  }
}

.Slider--label-side {
  display: flex;
  gap: 7px;
  align-items: center;

  & > * {
    display: inline-block;
  }

  & .Slider-labelContainer {
    padding-top: 0;
    flex-shrink: 0;
  }

  & .Slider-label {
    margin-inline-end: var(--slider-label-gap-x);
  }
}
